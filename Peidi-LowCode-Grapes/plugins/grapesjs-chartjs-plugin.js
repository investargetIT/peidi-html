/*! grapesjs-chartjs-plugin - 0.2.0 */
/** https://cdn.jsdelivr.net/npm/chart.js */
!function(t,a){'object'==typeof exports&&'object'==typeof module?module.exports=a():'function'==typeof define&&define.amd?define([],a):'object'==typeof exports?exports["grapesjs-chartjs-plugin"]=a():t["grapesjs-chartjs-plugin"]=a()}('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:this,(()=>(()=>{"use strict";var t={d:(a,e)=>{for(var o in e)t.o(e,o)&&!t.o(a,o)&&Object.defineProperty(a,o,{enumerable:!0,get:e[o]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a),r:t=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(t,'__esModule',{value:!0})}},a={};t.r(a),t.d(a,{default:()=>H});var e="grapesjs-chartjs-plugin",o="cjs-add-dataset",r="cjs-remove-dataset",n="cjs-add-background-color",i="cjs-add-border-color",l="cjs-chart-type",s="cjs-chart-labels",d="cjs-chart-title",c="cjs-chart-subtitle",u="cjs-chart-width",h="cjs-chart-height",p="cjs-dataset-label",v="cjs-dataset-data",b="cjs-dataset-background-color",g="cjs-dataset-border-color",f="cjs-dataset-border-width",y="cjs-dataset-custom",m={data:"65, 59, 80, 81, 56",label:"My Dataset",labels:"Jan, Feb, Mar, Apr, May",width:300,height:300,title:void 0,subtitle:void 0},C=[{type:"bar"},{type:"line",backgroundColor:{label:"addPointColor"},borderColor:{label:"addLineColor"},borderWidth:{label:"lineWidth",placeholder:"1",value:1},optionalDatasetProperties:[{property:"fill",type:"checkbox"},{property:"tension",type:"number",traitOptions:{min:0,placeholder:"0.1",step:.1}}]},{type:"pie",defaultLabels:"Jan, Feb, Mar",defaultData:"300, 50, 100",backgroundColor:{label:"addSegmentColor"},borderWidth:{placeholder:"1",value:1}},{type:"doughnut",defaultLabels:"Jan, Feb, Mar",defaultData:"300, 50, 100",backgroundColor:{label:"addSegmentColor"},borderWidth:{placeholder:"1",value:1}},{type:"polarArea",borderWidth:{placeholder:"1",value:1}},{type:"radar",defaultLabels:"Eating, Drinking, Sleeping, Running",defaultData:"70, 80, 90, 65"},{type:"bubble",defaultLabels:"-10, 0, 10, 0.5",defaultData:"0, 10, 5, 5.5",datasetType:"x-y-r",optionalDatasetProperties:[{property:"radial",type:"text",traitOptions:{value:"15, 5, 30, 10",label:"radius"}}]},{type:"scatter",defaultLabels:"-10, 0, 10, 0.5",defaultData:"0, 10, 5, 5.5",datasetType:"x-y"}];const w={bar:"<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 13a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm12-4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1zM9 5a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1zM4 20h14\"></path></svg>",bubble:"<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 16a3 3 0 1 0 6 0a3 3 0 1 0-6 0m11 3a2 2 0 1 0 4 0a2 2 0 1 0-4 0M10 7.5a4.5 4.5 0 1 0 9 0a4.5 4.5 0 1 0-9 0\"></path></svg>",doughnut:"<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2}><path d=\"M10 3.2A9 9 0 1 0 20.8 14a1 1 0 0 0-1-1H16a4.1 4.1 0 1 1-5-5V4a.9.9 0 0 0-1-.8\"></path><path d=\"M15 3.5A9 9 0 0 1 20.5 9H16a9 9 0 0 0-1-1z\"></path></g></svg>",line:"<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 19h16M4 15l4-6l4 2l4-5l4 4\"></path></svg>",pie:"<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2}><path d=\"M10 3.2A9 9 0 1 0 20.8 14a1 1 0 0 0-1-1H13a2 2 0 0 1-2-2V4a.9.9 0 0 0-1-.8\"></path><path d=\"M15 3.5A9 9 0 0 1 20.5 9H16a1 1 0 0 1-1-1z\"></path></g></svg>",polarArea:"<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\"><path fill=\"currentColor\" d=\"M30 17A15.017 15.017 0 0 0 15 2h-1v6.06A9.01 9.01 0 0 0 6.06 16H4v1a11.01 11.01 0 0 0 10 10.95V30h1a13.01 13.01 0 0 0 12.95-12H30ZM16 4.038A13.02 13.02 0 0 1 27.962 16H16Zm-2 6.042V16H8.08A7 7 0 0 1 14 10.08M6.055 18H14v7.939A9.01 9.01 0 0 1 6.055 18M16 27.955V18h9.955A11.02 11.02 0 0 1 16 27.955\"></path></svg>",radar:"<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2}><path d=\"m12 3l9.5 7L18 21H6L2.5 10z\"></path><path d=\"m12 7.5l5.5 4L15 17H8.5l-2-5.5z\"></path><path d=\"m2.5 10l9.5 3l9.5-3\"></path><path d=\"M12 3v10l6 8M6 21l6-8\"></path></g></svg>",scatter:"<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 256 256\"><path fill=\"currentColor\" d=\"M230 208a6 6 0 0 1-6 6H32a6 6 0 0 1-6-6V48a6 6 0 0 1 12 0v154h186a6 6 0 0 1 6 6m-98-50a10 10 0 1 0-10-10a10 10 0 0 0 10 10m-24-56a10 10 0 1 0-10-10a10 10 0 0 0 10 10m-32 72a10 10 0 1 0-10-10a10 10 0 0 0 10 10m96-48a10 10 0 1 0-10-10a10 10 0 0 0 10 10m24-40a10 10 0 1 0-10-10a10 10 0 0 0 10 10m-8 68a10 10 0 1 0 10 10a10 10 0 0 0-10-10\"></path></svg>"};var j=function(t,a){return t.I18n.t("".concat(e,".").concat(a))},k=void 0&&(void 0).__awaiter||function(t,a,e,o){return new(e||(e=Promise))((function(r,n){function i(t){try{s(o.next(t))}catch(t){n(t)}}function l(t){try{s(o["throw"](t))}catch(t){n(t)}}function s(t){var a;t.done?r(t.value):(a=t.value,a instanceof e?a:new e((function(t){t(a)}))).then(i,l)}s((o=o.apply(t,a||[])).next())}))},x=void 0&&(void 0).__generator||function(t,a){var e,o,r,n={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i["throw"]=l(1),i["return"]=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(e)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(n=0)),n;)try{if(e=1,o&&(r=2&l[0]?o["return"]:l[0]?o["throw"]||((r=o["return"])&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(!(r=n.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){n=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){n.label=l[1];break}if(6===l[0]&&n.label<r[1]){n.label=r[1],r=l;break}if(r&&n.label<r[2]){n.label=r[2],n.ops.push(l);break}r[2]&&n.ops.pop(),n.trys.pop();continue}l=a.call(t,n)}catch(t){l=[6,t],o=0}finally{e=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function D(t){const a=this,e=()=>{if(void 0===a.firstChild?.$chartjs){r();const t=a.firstChild;window.loadedCharts[a.id]=new window.Chart(t)}o()},o=()=>{t.chartjsOptions&&(t.chartjsOptions.options&&(window.loadedCharts[a.id].options=t.chartjsOptions.options),t.chartjsOptions.data&&(window.loadedCharts[a.id].data=t.chartjsOptions.data),window.loadedCharts[a.id].update())},r=()=>{a.hasChildNodes()&&(a.innerHTML="");const t=document.createElement("canvas");t.style.width="100%",t.style.height="100%",a.appendChild(t)};if(void 0===window.Chart){window.loadedCharts={};const t=document.createElement("script");t.onload=e,t.src="../dependency/chart.js",document.body.appendChild(t)}else e()}var L=function(t,a,e){return t?"".concat(b,"-").concat(a,"-").concat(e):"".concat(g,"-").concat(a,"-").concat(e)},T=function(t,a){var e=a.id.split("-").pop();if(e&&a.category){var o=a.id.includes(n),r=t.getTraits(),i=A(r,o,a.category),l=i.counter,s=i.lastIndex,d=(s>0?s:r.findIndex((function(t){return a.id===t.id})))+1,c=L(o,l,e);if(0===l){var u=B(a);u&&u.classList.remove("cjs-button-disabled")}t.addTrait([{type:"color",label:!1,name:c,category:a.category.attributes}],{at:d})[0]}},O=function(t,a){var e=a.id.split("-").pop(),o=a.id.includes(n),r=t.getTraits();if(a.category){var i=A(r,o,a.category).counter;if(1===i){var l=B(a);l&&l.classList.add("cjs-button-disabled")}if(i>0&&e){var s=L(o,i-1,e);t.getTrait(s).setValue(""),t.removeTrait(s)}}},A=function(t,a,e){for(var o,r=t.length,n=0,i=0,l=0,s=0;s<r;s++)if("color"===t[s].attributes.type&&e.id===(null===(o=t[s].category)||void 0===o?void 0:o.id)){var d=t[s];a?d.id.includes(b)&&(n=s,i++):d.id.includes(g)&&(n=s,l++)}return{counter:a?i:l,lastIndex:n}},B=function(t){var a=document.getElementById("".concat(t.id,"-wrapper"));if(a)return a.querySelector("[data-cjs-remove-color]")},M=void 0&&(void 0).__assign||function(){return M=Object.assign||function(t){for(var a,e=1,o=arguments.length;e<o;e++)for(var r in a=arguments[e])Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t},M.apply(this,arguments)},W=void 0&&(void 0).__rest||function(t,a){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&a.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)a.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e},S=void 0&&(void 0).__spreadArray||function(t,a,e){if(e||2===arguments.length)for(var o,r=0,n=a.length;r<n;r++)!o&&r in a||(o||(o=Array.prototype.slice.call(a,0,r)),o[r]=a[r]);return t.concat(o||Array.prototype.slice.call(a))};const N={"grapesjs-chartjs-plugin":{category:"Charts",blocks:{bar:"Bar Chart",line:"Line Chart",pie:"Pie Chart",doughnut:"Doughnut Chart",polarArea:"Polar Area Chart",radar:"Radar Chart",bubble:"Bubble Chart",scatter:"Scatter Chart"},traits:{addBackgroundColor:"Add Background Color",addBorderColor:"Add Border Color",addColor:"Add Color",addDataset:"Add Dataset",addLineColor:"Add Line Color",addPointColor:"Add Point Color",addSegmentColor:"Add Segment Color",borderWidth:"Border Width",chartSettings:"Chart Settings",dataset:"Dataset",datasetData:"Values",datasetLabels:"Labels",datasetName:"Name",height:"Height",fill:"Fill",lineWidth:"Line Width",radius:"Radius",removeColor:"Remove Color",removeDataset:"Remove Dataset",tension:"Tension",title:"Title",subtitle:"Subtitle",width:"Width"}}};const P=".cjs-button-wrapper {\n  padding: 5px 0px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.cjs-button-container {\n  width: auto;\n}\n\n.cjs-button {\n  color: var(--gjs-font-color);\n  fill: var(--gjs-font-color);\n  background: none;\n  border: none;\n  cursor: pointer;\n  outline: none;\n  position: static;\n  opacity: 0.75;\n  padding: 0;\n  width: 18px;\n  height: 18px;\n}\n\n.cjs-button-disabled {\n  opacity: 0.2 !important;\n  cursor: auto !important;\n}";var I=void 0&&(void 0).__assign||function(){return I=Object.assign||function(t){for(var a,e=1,o=arguments.length;e<o;e++)for(var r in a=arguments[e])Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t},I.apply(this,arguments)};const H=function(t,a){var e;void 0===a&&(a={}),document.head.insertAdjacentHTML("beforeend","<style>".concat(P,"</style>"));var L=I({i18n:{},chartjsOptions:{maintainAspectRatio:!1},blocks:C.map((function(t){return"chartjs-".concat(t.type)})),category:{id:"chartjs",label:"category"}},a);null===(e=t.I18n)||void 0===e||e.addMessages(I({en:N},L.i18n)),function(t){t.TraitManager.addType("cjs-add-color-button",{noLabel:!0,templateInput:function(){return""},createInput:function(a){var e,o=a.trait,r=a.component,n=null!==(e=o.attributes.label)&&void 0!==e?e:j(t,"traits.addColor"),i=document.createElement("div");i.innerHTML="<div id=\"".concat(o.id,"-wrapper\" class=\"cjs-button-wrapper\" data-cjs-wrapper>\n            <span data-cjs-label>\n                ").concat(n,"\n            </span>\n            <div class=\"cjs-button-container\">\n              <button title=\"").concat(j(t,"traits.removeColor"),"\" type=\"button\" class=\"cjs-button cjs-button-disabled\" data-cjs-remove-color>\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 12h14\"></path></svg>\n              </button>\n              <button title=\"").concat(j(t,"traits.addColor"),"\" type=\"button\" class=\"cjs-button\" data-cjs-add-color>\n                <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 5v14m-7-7h14\"></path></svg>\n              </button>\n          </div>\n      </div>");var l=i.getElementsByTagName("button")[0],s=i.getElementsByTagName("button")[1];return l.addEventListener("click",(function(){O(r,o)})),s.addEventListener("click",(function(){T(r,o)})),i.firstElementChild}})}(t),function(t,a){var e=t.DomComponents,w={id:"cjs-common",label:j(t,"traits.chartSettings")};e.addType("chartjs",{model:{defaults:{script:D,"script-props":["chartjsOptions"],resizable:{ratioDefault:!0,tc:!1,bc:!1,cl:!1,cr:!1,onEnd:function(a,e){var o=e.el,r=t.getSelected(),n=o.offsetHeight,i=o.offsetWidth,l=null==r?void 0:r.getTrait(u),s=null==r?void 0:r.getTrait(h);null==l||l.setValue(i),null==s||s.setValue(n)}},unstylable:["width","height"],traits:function(a){var e,r,n,i=a.getAttributes()[l],p=C.find((function(t){return t.type===i})),v=null!==(e=null==p?void 0:p.datasetType)&&void 0!==e?e:"labels-data";a.set("chartComponentOptions",p);var b=[{type:"text",label:j(t,"traits.title"),name:d,category:w,value:m.title,placeholder:m.title},{type:"text",label:j(t,"traits.subtitle"),name:c,category:w,value:m.subtitle,placeholder:m.title},{type:"number",label:j(t,"traits.width"),name:u,category:w,value:m.width,placeholder:"300"},{type:"number",label:j(t,"traits.height"),name:h,category:w,value:m.height,placeholder:"300"},{type:"button",text:j(t,"traits.addDataset"),full:!0,name:o,category:w,command:function(t){var a=t.getSelected();null==a||a.addNewDatasetTraitsGroup()}}];return"labels-data"===v&&b.unshift({type:"text",label:j(t,"traits.datasetLabels"),name:s,category:w,value:null!==(r=null==p?void 0:p.defaultLabels)&&void 0!==r?r:m.labels,placeholder:null!==(n=null==p?void 0:p.defaultLabels)&&void 0!==n?n:m.labels}),b}},init:function(){if(null==this.getTrait("".concat(v,"-1")))this.addNewDatasetTraitsGroup();else for(var t=this.getAttributes(),a=0,e=function(t){var e=t.split("-").pop();if(e){var r=Number.parseInt(e);r>a&&(o.addNewDatasetTraitsGroup(),a++);var l=t.includes(b)?n:t.includes(g)?i:null;if(l){var s=o.getTraits().find((function(t){return t.id==="".concat(l,"-").concat(r)}));s&&T(o,s)}}},o=this,r=0,l=Object.keys(t);r<l.length;r++)e(l[r]);this.on("change:attributes",this.handleAttrChange)},handleAttrChange:function(t){t.view.updateChart()},addNewDatasetTraitsGroup:function(){var t=this.getNewDatasetTraitsGroup();this.addTrait(t);var a=t.reduce((function(t,a){return a.name&&a.value&&(t[a.name]=a.value),t}),{});Object.keys(t).length&&this.addAttributes(a)},getNewDatasetTraitsGroup:function(){for(var a,e,o,l,d,c,u,h,b,g,C,w,k,x,D,L,T,O,A,B,S,N=this.get("chartComponentOptions"),P=null!==(a=N.datasetType)&&void 0!==a?a:"labels-data",I=0,H=0,V=null!==(e=this.getTraits())&&void 0!==e?e:[];H<V.length;H++){var _=V[H];if((null===(o=_.category)||void 0===o?void 0:o.id)&&"cjs-common"!==_.category.id){var E=_.category.id.split("-").pop();if(E){var z=Number.parseInt(E);z>I&&(I=z)}}}var G=I+1,R=[],F={id:"cjs-dataset-options-".concat(G),label:"#".concat(G," ").concat(j(t,"traits.dataset")),open:1===G};if(G>1&&R.push({type:"button",text:j(t,"traits.removeDataset"),full:!0,name:"".concat(r,"-").concat(G),category:F,command:function(){var a,e=t.getSelected();if(e){for(var o=e.getTraits().filter((function(t){var a;return(null===(a=t.category)||void 0===a?void 0:a.id)===F.id})),r=0,n=o;r<n.length;r++){var i=n[r];i.off("change:value"),i.setValue(""),e.removeTrait(i.id)}null===(a=e.view)||void 0===a||a.removeDataset(G-1)}}}),R.push({type:"text",label:j(t,"traits.datasetName"),name:"".concat(p,"-").concat(G),category:F,value:"#".concat(G," ").concat(m.label),placeholder:m.label}),"labels-data"!==P&&R.push({type:"text",label:j(t,"traits.datasetLabels"),name:"".concat(s,"-").concat(G),category:F,value:null!==(l=N.defaultLabels)&&void 0!==l?l:m.labels,placeholder:null!==(d=N.defaultLabels)&&void 0!==d?d:m.labels}),R.push({type:"text",label:j(t,"traits.datasetData"),name:"".concat(v,"-").concat(G),category:F,value:null!==(c=N.defaultData)&&void 0!==c?c:m.data,placeholder:null!==(u=N.defaultData)&&void 0!==u?u:m.data}),R.push({type:"cjs-add-color-button",name:"".concat(n,"-").concat(G),label:j(t,"traits.".concat(null!==(b=null===(h=null==N?void 0:N.backgroundColor)||void 0===h?void 0:h.label)&&void 0!==b?b:"addBackgroundColor")),category:F}),R.push({type:"cjs-add-color-button",name:"".concat(i,"-").concat(G),label:j(t,"traits.".concat(null!==(C=null===(g=null==N?void 0:N.borderColor)||void 0===g?void 0:g.label)&&void 0!==C?C:"addBorderColor")),category:F}),R.push({type:"number",label:j(t,"traits.".concat(null!==(k=null===(w=null==N?void 0:N.borderWidth)||void 0===w?void 0:w.label)&&void 0!==k?k:"borderWidth")),name:"".concat(f,"-").concat(G),value:null!==(D=null===(x=null==N?void 0:N.borderWidth)||void 0===x?void 0:x.value)&&void 0!==D?D:0,placeholder:null!==(T=null===(L=null==N?void 0:N.borderWidth)||void 0===L?void 0:L.placeholder)&&void 0!==T?T:"0",min:null!==(A=null===(O=null==N?void 0:N.borderWidth)||void 0===O?void 0:O.min)&&void 0!==A?A:0,category:F}),null===(B=null==N?void 0:N.optionalDatasetProperties)||void 0===B?void 0:B.length)for(var J=0,Z=N.optionalDatasetProperties;J<Z.length;J++){var q=Z[J],$=q.property,K=q.type,Q=q.traitOptions;W(q,["property","type","traitOptions"]),R.push(M(M({},Q),{type:K,label:j(t,"traits.".concat(null!==(S=null==Q?void 0:Q.label)&&void 0!==S?S:$)),name:"".concat(y,"-").concat($,"-").concat(G),category:F}))}return R}},view:{init:function(){var t;this.chart={data:{labels:[],datasets:[]},options:M({},null!==(t=a.chartjsOptions)&&void 0!==t?t:{})},this.updateChart()},getDatasetType:function(){var t,a=this.model.get("chartComponentOptions");return null!==(t=null==a?void 0:a.datasetType)&&void 0!==t?t:"labels-data"},updateChart:function(){var t,a,e=this.model.getTraits().reduce((function(t,a){return t[a.getName()]=a,t}),{}),o=(e.id,l),r=(e[o],e["data-gjs-type"],W(e,["id","symbol"==typeof o?o:o+"","data-gjs-type"])),n=this.getDatasetType();for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)){var m=r[i],C=m.getValue(),w=i.split("-"),j=Number.parseInt(null!==(t=null==w?void 0:w[w.length-1])&&void 0!==t?t:"1"),k=null===(a=S([],w,!0))||void 0===a?void 0:a.splice(0,Number.isNaN(j)?w.length:w.length-1).join("-"),x=j-1;switch(k){case v:this.updateChartDatasetData(C,x);break;case p:this.updateChartDatasetLabel(C,x);break;case s:this.updateChartLabels(C,x);break;case d:this.updateChartTitle(C);break;case c:this.updateChartSubtitle(C);break;case h:this.model.addStyle({height:"".concat(null!=C?C:0,"px")});break;case u:this.model.addStyle({width:"".concat(null!=C?C:0,"px")});break;case f:var D={borderWidth:Number.parseInt(C),index:x};this.updateChartDatasetBorderWidth(D);break;default:var L=Number.parseInt(w[w.length-2]);if(null==k?void 0:k.includes(b))this.updateChartDatasetBackgroundColor(C,x,L);else if(null==k?void 0:k.includes(g))this.updateChartDatasetBorderColor(C,x,L);else if(null==k?void 0:k.includes(y))if("labels-data"===n)this.updateOptionalDatasetProperty(m,k,C,x);else{var T=k.split("-").pop();this.updateChartByDatasetType(T,C,x)}}}this.updateChartView()},updateChartView:function(){this.model.set("chartjsOptions",this.chart),this.model.trigger("change:chartjsOptions")},addDataset:function(){this.chart.data.datasets||(this.chart.data.datasets=[]);var t=this.model.get("chartComponentOptions");this.chart.data.datasets.push({type:t.type,backgroundColor:["rgba(54, 162, 235, 0.5)"],borderColor:["rgb(54, 162, 235)"],data:[]})},removeDataset:function(t){null!=this.chart.data.datasets[t]&&(this.chart.data.datasets.splice(t,1),this.updateChartView())},updateChartDatasetData:function(t,a){if(!this.chart.data.datasets[a]){var e=this.model.get("chartComponentOptions");this.chart.data.datasets[a]={type:e.type}}this.updateChartByDatasetType("data",t,a)},updateChartDatasetLabel:function(t,a){if(!this.chart.data.datasets[a]){var e=this.model.get("chartComponentOptions");this.chart.data.datasets[a]={type:e.type}}this.chart.data.datasets[a].label=t},updateChartDatasetBorderWidth:function(t){var a=t.borderWidth,e=t.index;this.chart.data.datasets[e].borderWidth||(this.chart.data.datasets[e].borderWidth=0),this.chart.data.datasets[e].borderWidth="number"==typeof a&&a>=0?a:0},updateChartDatasetBackgroundColor:function(t,a,e){var o={action:"update",backgroundColor:t,index:a,colorIndex:e};this.updateChartDatasetColor(o)},updateChartDatasetBorderColor:function(t,a,e){var o={action:"update",borderColor:t,index:a,colorIndex:e};this.updateChartDatasetColor(o)},updateChartDatasetColor:function(t){var a=t.action,e=t.backgroundColor,o=t.borderColor,r=t.index,n=t.colorIndex;this.chart.data.datasets[r]||(this.chart.data.datasets[r]={}),this.chart.data.datasets[r].backgroundColor||(this.chart.data.datasets[r].backgroundColor=[]),this.chart.data.datasets[r].borderColor||(this.chart.data.datasets[r].borderColor=[]),"unset"===a?(this.chart.data.datasets[r].backgroundColor=["rgba(54, 162, 235, 0.5)"],this.chart.data.datasets[r].borderColor=["rgb(54, 162, 235)"],this.chart.data.datasets[r].borderWidth=0):(null!=e&&(""===e?(this.chart.data.datasets[r].backgroundColor.splice(n,1),0===this.chart.data.datasets[r].backgroundColor.length&&(this.chart.data.datasets[r].backgroundColor=["rgba(54, 162, 235, 0.5)"])):this.chart.data.datasets[r].backgroundColor[n]=e),null!=o&&(""===o?(this.chart.data.datasets[r].borderColor.splice(n,1),0===this.chart.data.datasets[r].borderColor.length&&(this.chart.data.datasets[r].borderColor=["rgb(54, 162, 235)"])):this.chart.data.datasets[r].borderColor[n]=o))},updateChartLabels:function(t,a){this.updateChartByDatasetType("labels",t,a)},updateChartTitle:function(t){var a;this.chart.options.plugins=M(M({},null!==(a=this.chart.options.plugins)&&void 0!==a?a:{}),{title:{display:t.length>0,text:t}})},updateChartSubtitle:function(t){var a;this.chart.options.plugins=M(M({},null!==(a=this.chart.options.plugins)&&void 0!==a?a:{}),{subtitle:{display:t.length>0,text:t}})},updateOptionalDatasetProperty:function(t,a,e,o){var r=a.split("-").pop();if(r){this.chart.data.datasets[o]||(this.chart.data.datasets[o]={});var n=e;if("checkbox"===t.attributes.type&&!1!==e){var i=t.target.getAttributes();""===(null==i?void 0:i[t.id])&&(n=!0)}this.chart.data.datasets[o][r]=n}},updateChartByDatasetType:function(t,a,e){var o,r,n,i=this.getDatasetType();if("labels-data"===i)"labels"===t?this.chart.data.labels=a?a.split(",").map((function(t){return t.trim()})):[]:this.chart.data.datasets[e].data=a?a.split(",").map((function(t){return t.trim()})):[];else{var l=i.split("-"),s="labels"===t?l[0]:"data"===t?l[1]:l[2];if(null!=s){for(var d=S([],null!==(r=this.chart.data.datasets[e].data)&&void 0!==r?r:[],!0),c=null!==(n=null==a?void 0:a.split(",").map((function(t){return t.trim()})))&&void 0!==n?n:[],u=c.length>=d.length?c.length:d.length,h=[],p=0;p<u;p++){var v=M(M({},null!=d[p]?d[p]:{}),null!=c[p]?((o={})[s]=c[p],o):{});null==c[p]&&delete v[s],h.push(v)}this.chart.data.datasets[e].data=S([],h,!0)}}}}})}(t,L),function(t,a){k(void 0,void 0,void 0,(function(){var e,o,r,n,i,s,d,c,u,h,p,v,b,g;return x(this,(function(f){for(e=t.BlockManager,o="category"===a.category.label?j(t,a.category.label):null!==(h=a.category.label)&&void 0!==h?h:a.category,r=0,n=C;r<n.length;r++)i=n[r],s=null!==(p=i.type)&&void 0!==p?p:"bar",d="chartjs-".concat(s),(null===(v=a.blocks)||void 0===v?void 0:v.includes(d))&&(c=w[i.type],e.add(d,{label:j(t,"blocks.".concat(s)),category:{id:null!==(g=null===(b=a.category)||void 0===b?void 0:b.id)&&void 0!==g?g:"chartjs",label:o},content:{tagName:"div",type:"chartjs",attributes:(u={"data-gjs-type":"chartjs"},u[l]=s,u)},media:c}));return[2]}))}))}(t,L)};return a})()));
//# sourceMappingURL=index.js.map