/*! grapesjs-script-editor - 1.0.4 */
!function(t,e){'object'==typeof exports&&'object'==typeof module?module.exports=e():'function'==typeof define&&define.amd?define([],e):'object'==typeof exports?exports["grapesjs-script-editor"]=e():t["grapesjs-script-editor"]=e()}('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:this,()=>(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(t,'__esModule',{value:!0})}},e={};t.r(e),t.d(e,{default:()=>c,plugin:()=>a});var o='edit-script';var n=void 0&&(void 0).__assign||function(){return n=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},n.apply(this,arguments)},r=function(t,e){void 0===e&&(e={});var r=t.Commands,i=t.Modal,a=t.Components,c=e.modalTitle,s=e.codeViewOptions,d=e.commandAttachScript,l=e.toolbarIcon,u=e.onRun,p=e.onError,f=e.starter,g=e.scriptTypesSupport,m=null,h=function(t,e){e instanceof HTMLElement?t.appendChild(e):e&&t.insertAdjacentHTML("beforeend",e)};(function(t){return typeof t==`string`})(g)&&(g=g.split(",")),function(t){return Array.isArray(t)}(g)&&(g=g.includes("*")?a.getTypes().map(function(t){return t.id}):g),g&&g.forEach(function(t){var r,i=null===(r=a.getType(t))||void 0===r?void 0:r.model;a.addType(t,{model:{initToolbar:function(){i.prototype.initToolbar.apply(this,arguments);var t=this.get("toolbar");(null==t?void 0:t.some(function(t){return t.command===o}))||(null==t||t.unshift(n({command:o,label:l},e.toolbarBtnCustomScript)),this.set("toolbar",t))}}})}),r.add(o,n({codeViewer:null,run:function(t){var e=t.getSelected();e&&this.showCustomCode(e)},stop:function(){i.close()},showCustomCode:function(e){var o=this,n=c;m||(m=this.getContent());var r=e.getScriptString()||f;i.open({title:n,content:m}).getModel().once("change:open",function(){return t.stopCommand(String(o.id))}),this.getCodeViewer().setContent(r)},getPreContent:function(){return""},getPostContent:function(){return""},getContent:function(){var e=document.createElement("div"),o=t.getConfig("stylePrefix");e.className="".concat(o,"attach-script"),h(e,this.getPreContent());var n=this.getCodeViewer();return n.refresh(),setTimeout(function(){return n.focus()},0),e.appendChild(n.getElement()),h(e,this.getPostContent()),h(e,this.getContentActions()),e},getContentActions:function(){var o=this,n=document.createElement("div");n.id="actns";var r=document.createElement("button"),i=t.getConfig("stylePrefix");r.innerHTML=e.buttonLabel||"Save",r.className="".concat(i,"btn-prim ").concat(i,"btn-save__inject-logic"),r.onclick=function(){return o.handleSave()};var a=document.createElement("div");return a.id="logic-toolbar",a.className="fa fa-bug",a.style="margin:5px;padding:10px;background:rgba(0,0,0,0.2);border-radius:3px;border:1px solid rgba(0,0,0,0.2);cursor:pointer",a.onclick=function(){return o.runCode()},n.appendChild(a),n.appendChild(r),n},handleSave:function(){var e,o=this.getCodeViewer().getContent();null===(e=t.getSelected())||void 0===e||e.set("script",o),t.Modal.close()},getCodeViewer:function(){return this.codeViewer||(this.codeViewer=t.CodeManager.createViewer(n({codeName:"javascript",theme:"hopscotch",readOnly:0,autoBeautify:1},s))),this.codeViewer},runCode:function(){try{var t=this.getCodeViewer().getContent();Function('"use strict";'+t)(),u&&u()}catch(t){console.log("error",t),p&&p(t)}}},d))},i=void 0&&(void 0).__assign||function(){return i=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},i.apply(this,arguments)},a=function(t,e){void 0===e&&(e={});var o=i({starter:"let el = this",toolbarIcon:'<i class="fa fa-file-code-o"></i>',scriptTypesSupport:["default","wrapper","text","textnode","image","video","svg"],toolbarBtnCustomScript:{},onRun:function(){return console.log("valid syntax")},onError:function(t){return console.log("error",t)},modalTitle:"Script",codeLabel:"JS",codeViewOptions:{},commandAttachScript:{}},e);r(t,o)};const c=a;return e})());
//# sourceMappingURL=index.js.map